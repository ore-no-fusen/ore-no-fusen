# 俺の付箋 - 要求仕様書 v1.5

**バージョン**: 1.5  
**日付**: 2026-01-28  
**ステータス**: ✅ 実装完全準拠 (Implementation Aligned)

---

## 1. 概要 (Overview)
「俺の付箋」は、**Markdownテキストファイルをそのまま付箋としてデスクトップに貼れる**シンプルで強力なメモアプリです。
一番の特徴は「**書いた内容＝ファイル名**」になること。タイトルを考える必要も、ファイル名を付ける手間もありません。
ただ書くだけで、自動的に整理されたテキストファイルとして保存されます。

---

## 2. 技術スタック (Technology Stack)

| レイヤー | 技術 | バージョン | 備考 |
| :--- | :--- | :--- | :--- |
| **フレームワーク** | Tauri | 2.x | Rust + Web技術のデスクトップアプリ基盤 |
| **フロントエンド** | Next.js | 15.x | React ベースの UI フレームワーク |
| **エディタ** | CodeMirror 6 | 6.x | Markdown 編集エンジン |
| **バックエンド** | Rust | - | ファイル操作、検索、システム連携 |
| **データ形式** | Markdown + YAML Frontmatter | - | 付箋データはプレーンテキスト |

---

## 3. データ形式 (Data Format)

### 3.1. 付箋ファイル形式
付箋は **Markdown ファイル (.md)** として保存される。メタデータは YAML Frontmatter で管理。

```markdown
---
windowX: 100
windowY: 200
windowWidth: 400
windowHeight: 300
backgroundColor: "#fffacd"
visible: true
tags:
  - 仕事
  - 重要
---
# これが1行目（＝ファイル名になる）

本文のテキストがここに続く...
**強調テキスト** も使える。

- [ ] タスク1
- [x] 完了済みタスク

![画像|0.5](assets/screenshot.png)
```

### 3.2. Frontmatter フィールド

| フィールド | 型 | 説明 |
| :--- | :--- | :--- |
| `windowX` | number | ウィンドウのX座標 |
| `windowY` | number | ウィンドウのY座標 |
| `windowWidth` | number | ウィンドウの幅 |
| `windowHeight` | number | ウィンドウの高さ |
| `backgroundColor` | string | 背景色（HEXカラー） |
| `visible` | boolean | 表示/非表示状態 |
| `tags` | string[] | タグの配列 |

### 3.3. ファイル名規則

```
NNNN_YYYY-MM-DD_コンテキスト.md
```

| 部分 | 説明 |
| :--- | :--- |
| `NNNN` | 4桁の連番（0001〜9999） |
| `YYYY-MM-DD` | 作成日 |
| `コンテキスト` | 1行目から自動生成（禁則文字は `_` に置換） |

**禁則文字**: `\ / : * ? " < > |`

---

## 4. フォルダ構造 (Folder Structure)

```
ベースフォルダ/           ← 設定で指定
├── 0001_2026-01-15_会議メモ.md
├── 0002_2026-01-16_買い物リスト.md
├── 0003_2026-01-17_アイデア.md
├── assets/              ← 画像保存先
│   ├── 2026-01-15_001.png
│   └── 2026-01-16_002.png
├── Archive/             ← アーカイブ先（タグなし付箋）
│   └── 0004_2026-01-10_古いメモ.md
├── Tags/                ← タグ別フォルダ
│   ├── 仕事/
│   │   └── (タグ付き付箋のハードリンク)
│   └── プライベート/
│       └── (タグ付き付箋のハードリンク)
└── Trash/               ← ゴミ箱
    └── (削除された付箋)
```

---

## 5. 機能一覧 (Feature Matrix)

| カテゴリ | 機能名 | 概要 |
| :--- | :--- | :--- |
| **基本機能** | Markdown付箋 | 常駐・自動保存、ファイル名自動同期 |
| **装飾・リンク** | リッチテキスト | 赤太字、見出し、リンク |
| **画像** | 画像・キャプチャ | スクショ挿入、リサイズ |
| **整理** | タグ・色分け | タグ絞り込み、背景色変更 |
| **検索** | 全文検索 | 全付箋から検索、ジャンプ |

---

## 6. メニュー定義 (Menu Definitions)

### 6.1. 右クリックメニュー（付箋上）

| メニュー項目 | 動作 |
| :--- | :--- |
| 📝 新規メモ | 新しい付箋を作成 |
| 🎨 色を変更 → | サブメニュー: Blue, Pink, Yellow |
| 🏷️ タグ → | サブメニュー: タグ追加/選択/削除モード |
| 📂 エクスプローラーで開く | ファイルの場所を開く |
| 📦 アーカイブ | 付箋をアーカイブ |
| 🗑️ 削除 | 付箋をゴミ箱へ移動 |

### 6.2. システムトレイメニュー

| メニュー項目 | 動作 |
| :--- | :--- |
| 📝 新規メモ | 新しい付箋を作成 |
| 🔍 検索 | 全文検索を開く |
| 👁️ 全部戻す | 全ての付箋を表示 |
| 🙈 全部隠す | 全ての付箋を非表示 |
| 🏷️ タグで絞り込み → | サブメニュー: タグ一覧 |
| ⚙️ 設定 | 設定画面を開く |
| 🚪 終了 | アプリを終了 |

---

## 7. 設定項目 (Settings)

| 設定項目 | 説明 | デフォルト |
| :--- | :--- | :--- |
| **ベースフォルダ** | 付箋の保存先 | (初回設定必須) |
| **フォントサイズ** | エディタのフォントサイズ | 16px |
| **言語** | UI言語 | 日本語 |

---

## 8. ユースケース定義 (Use Cases)

### 8.1. 初期化・システム

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-01 | 初回セットアップ | 保存先フォルダを設定 |
| UC-02 | アプリ終了 | トレイ → 終了 |
| UC-03 | ボスキー | 全部隠す/全部戻す |

### 8.2. 付箋操作

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-04 | 新規作成 | 右クリック → 新規メモ |
| UC-05 | 移動 | ヘッダ/フッタ/本文をドラッグ |
| UC-06 | 色変更 | 右クリック → 色を変更 |
| UC-07 | ファイル名同期 | 1行目変更 → 0.8秒後に自動リネーム |
| UC-08 | モード切替 | ダブルクリックで表示⇔編集 |

### 8.3. 編集

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-09 | リッチテキスト | `**太字**`, `# 見出し`, `- リスト`, `[ ] タスク` |
| UC-10 | チェックボックス | クリックでトグル（表示モード） |
| UC-11 | リンク | URL/ファイルパスをクリックで開く |

### 8.4. 画像

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-12 | 画面キャプチャ | 📷ボタン → スクショ → 自動挿入 |
| UC-13 | 画像リサイズ | ドラッグでサイズ変更、`![alt|scale](path)` |

### 8.5. 整理

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-14 | タグ追加 | 右クリック → タグ |
| UC-15 | タグ削除 | 右クリック → タグ → 削除モード |
| UC-16 | タグ絞り込み | トレイ → タグで絞り込み |
| UC-17 | エクスプローラー | 右クリック → エクスプローラーで開く |
| UC-18 | アーカイブ | 右クリック → アーカイブ |
| UC-19 | 削除 | 右クリック → 削除 |

### 8.6. 検索

| UC | 名称 | 概要 |
| :--- | :--- | :--- |
| UC-20 | 全文検索 | トレイ → 検索、または Ctrl+F |

---

## 9. キーボードショートカット (Keyboard Shortcuts)

### 9.1. 付箋共通
| キー | 動作 |
| :--- | :--- |
| `Ctrl+F` | 全文検索を開く |
| `Escape` | 編集モード終了 |

### 9.2. 編集モード (CodeMirror)
| キー | 動作 |
| :--- | :--- |
| `Ctrl+Z` | 元に戻す (Undo) |
| `Ctrl+Shift+Z` | やり直す (Redo) |
| `Ctrl+A` | 全選択 |
| `Tab` | インデント |
| `Shift+Tab` | 逆インデント |

---

## 10. 将来機能 (Future Features)

| 機能名 | 概要 | ステータス |
| :--- | :--- | :--- |
| iPhone連携 | iCloud経由での付箋同期 | 🔮 構想 |
| 音声入力連携 | 音声認識によるテキスト入力 | 🔮 構想 |
| AI連携 | 要約生成、タグ提案 | 🔮 構想 |
| 検索ハイライト | 検索結果のハイライト表示 | ⏳ 実装済・動作せず |

---

## 11. 未実装・廃止機能 (Excluded Features)

| 機能 | 理由 |
| :--- | :--- |
| 論理削除 | v1.3で除外 |
| 常に手前に表示 | v1.3で除外 |

---
